<template name="household_mini">
  <div>  
    <a href="{{pathFor 'household'}}">Household: {{name}}</a>
  </div>
</template>

<template name="new_household">
  <h2>New Household</h2>
  <form>
    <input name="name" placeholder="name" />
    <input type="submit" value="Create Household" />
  </form>
  <a href="{{pathFor 'households'}}">See all households</a>
</template>

<template name="household">
  <a href="{{pathFor 'households'}}">See all households</a>
  <h2>Household "{{name}}"</h2>

  {{> household_users}}
  {{> household_expenses}}
</template>

<template name="household_users">
  <h3>Users</h3>
  <ul>
    {{#each users}}
      <li>{{primary_email}}</li>
    {{/each}}
  </ul>

  {{> household_add_user}}
  {{> household_leave}}
</template>

<template name="households">
  <h3>Listing all households</h3>
  {{#each households}}
    {{> household_mini}}
  {{/each}}
  <a href="{{pathFor 'new_household'}}">Create a new household</a>
</template>

<template name="household_add_user">
  {{error}}
  <p>Add user:</p>
  <form>
    <input type="email" name="email" placeholder="email" />
    <input type="submit" value="Add" />
  </form>
</template>

<template name="household_leave">
  <button>Leave household</button>
</template>

<template name="household_expenses">
  <h3>Expenses</h3>
  <table>
    {{#each expenses}}
      <tr>
        <td>Creator</td>
        <td>Total Cost</td>
        <td>Description</td>
        {{#each object portions}}
          {{#with getUser key}}
            <td>
              {{primary_email}}
            </td>
          {{/with}}
        {{/each}}
      </tr>
      <tr>
        <td>{{user_email user_id}}</td>
        <td>{{cost}}</td>
        <td>{{description}}</td>
        {{#each object portions}}
          <td>
            {{value}}
          </td>
        {{/each}}
      </tr>
    {{/each}}

    <tr><td colspan="100">Total expenses:</td></tr>

    <tr>
      {{#each object totalExpenses}}
        <td>
          {{user_email key}}
        </td>
      {{/each}}
    </tr>
    <tr>
      {{#each object totalExpenses}}
        <td>
          {{value}}
        </td>
      {{/each}}
    </tr>
  </table>
  {{> household_add_expense}}
</template>

<template name="household_add_expense">
  <h3>Add Expense</h3>
  <form>
    <input type="number" name="cost" placeholder="cost" />
    <input type="text" name="description" placeholder="description" />
    <table>
      <tr>
        {{#each users}}
          <td>
            {{primary_email}}
          </td>
        {{/each}}
      </tr>
      <tr>
        {{#each users}}
          <td>
            <input type="number" name="portions.{{_id}}" />
          </td>
        {{/each}}
      </tr>
    </table>
    <input type="submit" value="Save expense" />
  </form>
</template>
